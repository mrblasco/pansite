<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="W. Caleb McDaniel" />


<title>Applescript and Notational Velocity</title>

<script src="applescript-and-notational-velocity_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="applescript-and-notational-velocity_files/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="applescript-and-notational-velocity_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="applescript-and-notational-velocity_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="applescript-and-notational-velocity_files/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="applescript-and-notational-velocity_files/highlight/textmate.css"
      type="text/css" />
<script src="applescript-and-notational-velocity_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="applescript-and-notational-velocity_files/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->





<!--Begin contents of _navigation.html which are inserted using the include-before-body option in pandoc.-->
<div class="header">
        <ul class= "nav nav-pills pull-right">
            <li class="hidden-phone"><a href="./cv.html">CV</a></li>
            <li class="hidden-phone"><a href="./research.html">Research/</a></li>
            <li class="hidden-phone"><a href="./teaching.html">Teaching/</a></li>
            <li class="hidden-phone"><a href="./hacks.html">Hacks/</a></li>
			<li class="visible-phone"><a href="./index.html#site-map">&larr; Site Map</a></li>
			<li><a href="index.html"><img src="./photo.jpg" class="pull-left"></a></li>
        </ul>
</div>

<!--End contents of _navigation.html which are inserted using the include-before-body option in pandoc.-->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Applescript and Notational Velocity</h1>
<h4 class="author"><em>W. Caleb McDaniel</em></h4>
<h4 class="date"><em>October 1, 2011</em></h4>

</div>


<div class="well">
<p>This post was originally published on my old blog as <a href="http://mcdaniel.blogs.rice.edu/?p=175" title="Permanent Link: Applescript and Notational Velocity">Applescript and Notational Velocity</a>.</p>
</div>
<p>In an earlier post, I explained <a href="http://mcdaniel.blogs.rice.edu/?p=153">how I use plain text files and Notational Velocity as a task-management alternative</a> to the GTD program <a href="http://culturedcode.com/things/">Things</a>. Towards the end of that post, I also hinted that I have been able to automate parts of my system by using some Applescript and Automator tricks. Most of these tricks depend on using an apparently little-known feature of Notational Velocity, which is the ability to perform the “search” command on your notes using Applescript.</p>
<p>As <a href="http://notational.net/">Notational Velocity</a> users know, what makes the program unique is the fact that most of its functions begin in the “search” bar. If you want to create a note, you go to the search bar, begin typing the title of your new note, and click enter to create it. If you want to open an existing note, you also go to the search bar and begin entering the text that you want to find.</p>
<p>With the release of <a href="http://notational.net/releasenotes/release2/">Version 2.0β4</a> at the beginning of 2011, however, it became possible to “search” for text strings in NV using Applescript. (If you are new to Applescript, check out <a href="http://mac.appstorm.net/how-to/applescript/the-ultimate-beginners-guide-to-applescript/">the Ultimate Beginner’s Guide</a>.) This makes it relatively simple to write an Applescript that will create a new note in Notational Velocity, like this:</p>
<pre><code>    tell application &quot;Notational Velocity&quot;
        activate
        search &quot;Name of the new note&quot;
        tell application &quot;System Events&quot;
            keystroke return
            key code 53
            set visible of process &quot;Notational Velocity&quot; to false
        end tell
    end tell</code></pre>
<p>The first part of this Applescript tells Notational Velocity to search for whatever text is between the quotation marks after <code>search</code> (in this case, <code>Name of the new note</code>). The second part of the script uses System Events to simulate the process of hitting return, which you would ordinarily do in Notational Velocity to create your new note after entering its title in the search bar. It also adds <code>key code 53</code> (which has the same effect as entering the Escape key) so that the query is cleared from the search bar after the new note is created. Finally, since the first part of the script activated Notational Velocity, thereby bringing it to the foreground, the script concludes by hiding the NV window from view so you can go back to whatever you were doing.</p>
<p>With some slight modifications, you can also use a script like this to enter some text into the body of the new note you create, but more on that in a moment. First, if you are familiar with NV and are following along so far, you’ll probably realize that this script has some important limitations. Namely, if the text string that you’re searching for is already in a note in your NV database, you’ll run into some problems because instead of creating a new note, NV will find the note with that text.</p>
<p>Nonetheless, this script has been useful in helping me to automate parts of my previously-described GTD system. Here’s an example: in a previous post, I explained <a href="http://mcdaniel.blogs.rice.edu/?p=113">how and why I use my iPad to grade student papers</a>. I also use my iPad to annotate other documents that need feedback from me. So when I receive a paper to grade or a document to annotate, there are two things I need to do: (a) get the file to my iPad for annotation; (b) add a “to do” (or a <code>qq</code>, using <a href="http://mcdaniel.blogs.rice.edu/?p=153">the syntax I explained before</a>) to Notational Velocity so I’ll remember that I need to read the file. To accomplish both of these tasks at once, I use an Automator workflow that incorporates a beefed-up version of the simple script above.</p>
<p>Before showing you the workflow, however, I should also explain why I now prefer to use <a href="http://www.goodiware.com/goodreader.html">GoodReader</a>, rather than <a href="http://www.ajidev.com/iannotate/">iAnnotate</a>, for most of the annotation that I do on my iPad.</p>
<div id="goodreader-versus-iannotate" class="section level3">
<h3>GoodReader versus iAnnotate</h3>
<p>When I wrote my earlier post on grading with my iPad, I was using <a href="http://www.ajidev.com/iannotate/">iAnnotate</a>, and sometimes I still do. But I’ve switched to <a href="http://www.goodiware.com/goodreader.html">GoodReader</a> for annotating most PDFs, in large part because the process of syncing files to my iPad is easier and more intuitive. Since I wrote my earlier post, GoodReader has also added a full slate of annotation tools that compares nicely with iAnnotate and even adds some features that work better, in my view.</p>
<p>I learned about GoodReader’s killer syncing capabilities from <a href="http://macpowerusers.com/2011/04/mpu-048-goodreader/">this episode of Mac Power Users</a>, which also discusses lots of other features peculiar to GoodReader. The most important payoff is this: GoodReader allows me to <a href="http://www.goodiware.com/gr-man-tr-servers.html#sync">keep particular folders in my Dropbox automatically synchronized</a> between my iPad and my desktop. For example, I have a folder in my <a href="http://db.tt/SXfRhdY">Dropbox</a> called “annotate.” I have set up GoodReader so that this folder is synchronized on my iPad. So whenever I add a file on my laptop to the “annotate” folder, I can get this file on my iPad just by tapping the “Sync” button in GoodReader. Then, when I annotate the file on my iPad, I just tap “Sync” again, and the marked-up file will appear in my Dropbox and on my laptop. Nifty, no?</p>
</div>
<div id="an-example-workflow" class="section level3">
<h3>An example workflow</h3>
<p>Now that I’m using GoodReader, Step A of the workflow I described above (getting the file to my iPad) basically means moving the file into my “annotate” folder so that it can be synchronized to GoodReader later. The next step in my workflow is then to add a <code>qq</code> note in Notational Velocity that tells me to read the file. To do both, I use Automator. (If you’re new to Automator, here’s <a href="http://mac.appstorm.net/how-to/applescript/automator-the-ultimate-automation-assistant/">an introduction</a>.)</p>
<p>To see what my Automator workflow looks like, click on the image below to enlarge.</p>
<p><a href="http://mcdaniel.blogs.rice.edu/files/2011/10/ToAnnotate.jpg"><img src="http://mcdaniel.blogs.rice.edu/files/2011/10/ToAnnotate-300x291.jpg" title="ToAnnotate" alt="image" /></a></p>
<p>The first step in this workflow moves the file in question to my annotate folder, so that it’s ready to be accessed on my iPad via Dropbox synchronization. The workflow then passes the name of the file I need to annotate to an Applescript, which creates a note in Notational Velocity that says <code>qq Read examplefile.pdf</code>. (This Applescript is longer than the one I showed you above, because I don’t want the title of my to-do to include the whole pathname of the file. In this example, I also then have the Applescript put the pathname in the body of the new note, before simulating the Escape key and hiding Notational Velocity from view.)</p>
<p>Sometimes the file I need to annotate comes to me as a Microsoft Word document, in which case I also need to turn the file into a PDF. So I have a separate Automator workflow with an extra step at the beginning that turns Word documents into PDF files. Click the image below to see what I mean.</p>
<p><a href="http://mcdaniel.blogs.rice.edu/files/2011/10/ToAnnotateWord.jpg"><img src="http://mcdaniel.blogs.rice.edu/files/2011/10/ToAnnotateWord-300x191.jpg" title="ToAnnotateWord" alt="image" /></a></p>
<p>To make a (potentially even longer) story short, I have saved these Automator workflows as plug-ins for Finder. (I am still using Mac OS 10.5.8, and Automator underwent some significant changes in Snow Leopard, including the elimination of “plug-ins” in favor of <a href="http://gigaom.com/apple/quick-tip-automator-and-services-in-snow-leopard/">something similar called Services</a>) So when I have a file in my Finder that I want to annotate in GoodReader, I basically right-click on the file, navigate to my “To Annotate” workflow, click on it, and voila: the file is moved to my annotate folder, and a new task is created reminding me to read the file. I’ll see that task next time I do my GTD review.</p>
<p>That’s just one example of the kinds of automation I can add into my plain-text GTD system, and it’s certainly the one I use the most. But since <a href="http://www.tuaw.com/2008/04/14/mac-101-schedule-your-scripts/">you can schedule Applescripts to run on particular dates in iCal</a>, it’s also easy to imagine how you could use a simple Notational Velocity Applescript and iCal to simulate the process of automatically creating scheduled or repeating tasks in <a href="http://culturedcode.com/things/">Things</a>. But that is a post for another day.</p>
<p><strong>UPDATE:</strong> I’ve since figured out how to do this particular workflow much more efficiently using a shell script and the command line. Still, the Applescript functionality of NV might be useful for other workflows.</p>
</div>

<!--Begin contents of _footer.html which are inserted using the include-after-body option in pandoc.-->

<!--Footer-->

<footer>

		<ul class="nav nav-pills pull-right hidden-phone">
            <li class="transparent"><script type="text/javascript">
			<!--
			h='&#114;&#x69;&#x63;&#x65;&#46;&#x65;&#100;&#x75;';a='&#64;';n='&#x63;&#x61;&#108;&#x65;&#98;#46;&#x6d;&#x63;&#100;&#x61;&#110;&#x69;&#x65;&#108;';e=n+a+h;
			document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'">'+'<img src='+'"./img/glyph_em'+'ail.png"'+'>'+'<\/'+'a'+'>');
			// -->
			</script><noscript>&#x63;&#x61;&#108;&#x65;&#98;&#46;&#x6d;&#x63;&#100;&#x61;&#110;&#x69;&#x65;&#108;&#32;&#x61;&#116;&#32;&#114;&#x69;&#x63;&#x65;&#32;&#100;&#x6f;&#116;&#32;&#x65;&#100;&#x75;</noscript>
			</li>
			<li class="transparent"><a href="http://www.twitter.com/wcaleb" title="My Twitter feed" class="transparent"><img src="./img/glyph_twitter.png"></a></li>
			<li class="transparent"><a href="http://pinboard.in/u:wcaleb" title="My Pinboard"><img src="./img/glyph_pinboard.png"></a></li>
			<li class="transparent"><a href="http://clippings.tumblr.com" title="My Tumblr blog, Clippings"><img src="./img/glyph_tumblr.png"></a></li>
			<li class="transparent"><a href="http://github.com/wcaleb" title="My Github repos"><img src="./img/glyph_github.png"></a></li>
		</ul>

<ul class="nobullet">
<li><a href="colophon.html">Colophon/</a></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">License/</a></li>
<li><a href="./feed.xml">RSS/</a></li>
<li class="visible-phone"><a href="./index.html#contact">Contact/</a></li>
</ul>

</footer>

<!--Statcounter-->

<script type="text/javascript">
var sc_project=2874620; 
var sc_invisible=0; 
var sc_partition=29; 
var sc_security="cc89e61f"; 
</script>

<script type="text/javascript" src="http://www.statcounter.com/counter/counter_xhtml.js"></script>

<noscript><div class="statcounter"><a class="statcounter" href="http://www.statcounter.com/"><img class="statcounter" src="http://c30.statcounter.com/2874620/0/cc89e61f/0/" alt="invisible hit counter" /></a></div></noscript>

<!--End contents of _footer.html which are inserted using the include-after-body option in pandoc.-->



</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
